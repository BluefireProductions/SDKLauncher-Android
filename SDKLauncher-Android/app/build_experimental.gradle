apply plugin: 'com.android.model.application'

def ndk_skipX86 = (rootProject.hasProperty("readium_ndk_skipX86") && rootProject.readium_ndk_skipX86)
def ndk_skipARM = (rootProject.hasProperty("readium_ndk_skipARM") && rootProject.readium_ndk_skipARM)
def ndk_clang = (rootProject.hasProperty("readium_ndk_clang") && rootProject.readium_ndk_clang)
def ndk_debug = (rootProject.hasProperty("readium_ndk_debug") && rootProject.readium_ndk_debug)

model {
    android {
        compileSdkVersion = 24
        buildToolsVersion = "25"

        defaultConfig.with {
            applicationId="org.readium.sdk.android.launcher"
            minSdkVersion.apiLevel   = 24
            targetSdkVersion.apiLevel = 24
        }
    }

    android.sources {
        main {
            jniLibs {
                dependencies {
                    project ":epub3"
                    project ":lcp"
                }
            }
        }
        main {
            java {
                source {
                    srcDirs = [
                            './src/main/java',
                            '../../readium-sdk/Platform/Android/lib/src/main/java',
                            '../../readium-lcp-client/platform/android/lib/src/main/java'
                    ]
                }
            }
        }
    }

    android.buildTypes {
        debug {
            minifyEnabled = false
        }
        release {
            minifyEnabled = false
            proguardFiles.add(file('proguard-rules.txt'))
        }
    }

    android.productFlavors {
        create ("arm") {
            ndk.with {
                abiFilters.add("armeabi-v7a")
            }
        }

        if (!ndk_skipX86)
        create ("x86") {
            ndk.with {
                abiFilters.add("x86")
            }
        }
    }
}
